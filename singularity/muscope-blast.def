Bootstrap: docker
From: ubuntu:latest

%runscript

    pipeline $@

%setup
    mkdir "$SINGULARITY_ROOTFS/muscope-blast"
    mount --no-mtab --bind `pwd` "$SINGULARITY_ROOTFS/muscope-blast"

%environment
    #PATH=/app/FastQC:$PATH

%post

    apt update
    apt install -y apt-utils
    apt install -y git wget python3-dev python3-pip

    mkdir /app

    export LC_ALL=C
    /usr/bin/pip3 install --upgrade pip
    # biopython wants numpy already installed why?
    /usr/bin/pip3 install numpy
    /usr/bin/pip3 install /muscope-blast[dev,test]

    # create mount points for TACC directories
    mkdir /home1
    mkdir /scratch
    mkdir /work

%test
    echo "PATH=${PATH}"

    python3 --version
